generate a map to make sure the algorithm pad the map for missing cols